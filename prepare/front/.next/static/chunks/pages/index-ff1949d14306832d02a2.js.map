{"version":3,"sources":["webpack://_N_E/./components/PostForm.js","webpack://_N_E/./pages/index.js","webpack://_N_E/./node_modules/next/dist/build/webpack/loaders/next-client-pages-loader.js"],"names":["dispatch","_useSelector","state","post","imagePaths","addPostDone","_useInput","useInput","_useInput2","text","onChangeText","setText","onSubmit","trim","alert","formData","FormData","forEach","p","append","type","data","imageInput","onClickImageUpload","current","click","onChangeImages","e","console","log","target","files","imageFormData","call","f","onRemoveImage","index","style","margin","encType","onFinish","children","TextArea","value","onChange","maxLength","placeholder","name","multiple","hidden","ref","onClick","htmlType","map","v","i","display","src","concat","width","alt","__N_SSP","me","user","_useSelector2","mainPosts","hasMorePosts","loadPostsLoading","retweetError","onScroll","window","pageYOffset","document","documentElement","clientHeight","scrollHeight","_mainPosts","lastId","length","id","addEventListener","removeEventListener","AppLayout","PostCard","__NEXT_P","push"],"mappings":"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","file":"static/chunks/pages/index-ff1949d14306832d02a2.js","sourcesContent":["import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _slicedToArray from \"C:/job/react-nodebird/prepare/front/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport React, { useCallback, useRef, useEffect } from 'react';\nimport { Form, Input, Button } from 'antd';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { addPost, UPLOAD_IMAGES_REQUEST, REMOVE_IMAGE, ADD_POST_REQUEST } from '../reducers/post';\nimport useInput from '../hooks/useInput';\n\nvar PostForm = function PostForm() {\n  var dispatch = useDispatch();\n\n  var _useSelector = useSelector(function (state) {\n    return state.post;\n  }),\n      imagePaths = _useSelector.imagePaths,\n      addPostDone = _useSelector.addPostDone;\n\n  var _useInput = useInput(''),\n      _useInput2 = _slicedToArray(_useInput, 3),\n      text = _useInput2[0],\n      onChangeText = _useInput2[1],\n      setText = _useInput2[2];\n\n  useEffect(function () {\n    if (addPostDone) {\n      setText('');\n    }\n  }, [addPostDone]);\n  var onSubmit = useCallback(function () {\n    if (!text || !text.trim()) {\n      return alert('게시글을 작성하세요.');\n    }\n\n    var formData = new FormData();\n    imagePaths.forEach(function (p) {\n      formData.append('image', p);\n    });\n    formData.append('content', text);\n    return dispatch({\n      type: ADD_POST_REQUEST,\n      data: formData\n    });\n  }, [text, imagePaths]);\n  var imageInput = useRef();\n  var onClickImageUpload = useCallback(function () {\n    imageInput.current.click();\n  }, [imageInput.current]);\n  var onChangeImages = useCallback(function (e) {\n    console.log('images', e.target.files);\n    var imageFormData = new FormData();\n    [].forEach.call(e.target.files, function (f) {\n      imageFormData.append('image', f);\n    });\n    dispatch({\n      type: UPLOAD_IMAGES_REQUEST,\n      data: imageFormData\n    });\n  }, []);\n  var onRemoveImage = useCallback(function (index) {\n    return function () {\n      dispatch({\n        type: REMOVE_IMAGE,\n        data: index\n      });\n    };\n  }, []);\n  return /*#__PURE__*/_jsxs(Form, {\n    style: {\n      margin: '10px 0 20px'\n    },\n    encType: \"multipart/form-data\",\n    onFinish: onSubmit,\n    children: [/*#__PURE__*/_jsx(Input.TextArea, {\n      value: text,\n      onChange: onChangeText,\n      maxLength: 140,\n      placeholder: \"\\uC5B4\\uB5A4 \\uC2E0\\uAE30\\uD55C \\uC77C\\uC774 \\uC788\\uC5C8\\uB098\\uC694?\"\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      children: [/*#__PURE__*/_jsx(\"input\", {\n        type: \"file\",\n        name: \"image\",\n        multiple: true,\n        hidden: true,\n        ref: imageInput,\n        onChange: onChangeImages\n      }), /*#__PURE__*/_jsx(Button, {\n        onClick: onClickImageUpload,\n        children: \"\\uC774\\uBBF8\\uC9C0 \\uC5C5\\uB85C\\uB4DC\"\n      }), /*#__PURE__*/_jsx(Button, {\n        type: \"primary\",\n        style: {\n          \"float\": 'right'\n        },\n        htmlType: \"submit\",\n        children: \"\\uB4F1\\uB85D\"\n      })]\n    }), /*#__PURE__*/_jsx(\"div\", {\n      children: imagePaths.map(function (v, i) {\n        return /*#__PURE__*/_jsxs(\"div\", {\n          style: {\n            display: 'inline-block'\n          },\n          children: [/*#__PURE__*/_jsx(\"img\", {\n            src: \"http://localhost:3065/\".concat(v),\n            style: {\n              width: '200px'\n            },\n            alt: v\n          }), /*#__PURE__*/_jsx(\"div\", {\n            children: /*#__PURE__*/_jsx(Button, {\n              onClick: onRemoveImage(i),\n              children: \"\\uC81C\\uAC70\"\n            })\n          })]\n        }, v);\n      })\n    })]\n  });\n};\n\nexport default PostForm;","import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport AppLayout from '../components/AppLayout'; //next에선 import React를 반드시 할 필요가 없다.\n//next는 pages 폴더를 인식해서 개별적으로 페이지로 만든다.\n\nimport PostForm from '../components/PostForm';\nimport PostCard from '../components/PostCard';\nimport { LOAD_POSTS_REQUEST } from '../reducers/post';\n\nvar Home = function Home() {\n  var dispatch = useDispatch();\n\n  var _useSelector = useSelector(function (state) {\n    return state.user;\n  }),\n      me = _useSelector.me;\n\n  var _useSelector2 = useSelector(function (state) {\n    return state.post;\n  }),\n      mainPosts = _useSelector2.mainPosts,\n      hasMorePosts = _useSelector2.hasMorePosts,\n      loadPostsLoading = _useSelector2.loadPostsLoading,\n      retweetError = _useSelector2.retweetError;\n\n  useEffect(function () {\n    if (retweetError) {\n      alert(retweetError);\n    }\n  }, [retweetError]);\n  useEffect(function () {\n    function onScroll() {\n      if (window.pageYOffset + document.documentElement.clientHeight > document.documentElement.scrollHeight - 300) {\n        if (hasMorePosts && !loadPostsLoading) {\n          var _mainPosts;\n\n          var lastId = (_mainPosts = mainPosts[mainPosts.length - 1]) === null || _mainPosts === void 0 ? void 0 : _mainPosts.id;\n          dispatch({\n            type: LOAD_POSTS_REQUEST,\n            lastId: lastId\n          });\n        }\n      }\n    }\n\n    window.addEventListener('scroll', onScroll);\n    return function () {\n      window.removeEventListener('scroll', onScroll); //종료하지 않으면 큰일남.\n    };\n  }, [hasMorePosts, loadPostsLoading, mainPosts]); // 스크롤 끝까지 내릴시 로딩 후 이미지 가져오기\n\n  return /*#__PURE__*/_jsxs(AppLayout, {\n    children: [me && /*#__PURE__*/_jsx(PostForm, {}), mainPosts.map(function (post) {\n      return /*#__PURE__*/_jsx(PostCard, {\n        post: post\n      }, post.id);\n    })]\n  }) // AppLayout은 components 폴더에 있다.\n  // AppLayout 안에 있는 div는 {children}이 된다. \n  ;\n};\n\nexport var __N_SSP = true;\nexport default Home; // npm run dev 라고 입력하면 package.json 에 scripts에 정의해둔\n// 스크립트가 실행된다. dev 말고 정의해둔 값을 입력하면 스크립트 실행된다.\n// antd, antd icon 따로 설치 \n// antd는 ant design으로 중국 디자인 사이트\n// antd 안먹히면 @ctrl/tinycolor 3.3.1 추가해라\n// next를 사용하는 이유는 서버사이드 렌더링 때문","\n      (window.__NEXT_P = window.__NEXT_P || []).push([\n        \"/\",\n        function () {\n          return require(\"private-next-pages/index.js\");\n        }\n      ]);\n    "],"sourceRoot":""}