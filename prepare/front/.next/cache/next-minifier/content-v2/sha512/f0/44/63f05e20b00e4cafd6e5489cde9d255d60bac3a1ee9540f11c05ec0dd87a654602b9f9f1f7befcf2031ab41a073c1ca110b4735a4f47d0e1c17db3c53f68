{"code":"_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[17],{RNiq:function(e,t,n){\"use strict\";n.r(t),n.d(t,\"__N_SSP\",(function(){return p}));var c=n(\"nKUr\"),i=n(\"q1tI\"),r=n(\"/MKj\"),a=n(\"1zst\"),o=n(\"ODXe\"),s=n(\"Vl3Y\"),l=n(\"5rEg\"),u=n(\"2/Rp\"),d=n(\"p+NB\"),j=n(\"3zrx\"),f=function(){var e=Object(r.b)(),t=Object(r.c)((function(e){return e.post})),n=t.imagePaths,a=t.addPostDone,f=Object(j.a)(\"\"),b=Object(o.a)(f,3),p=b[0],O=b[1],h=b[2];Object(i.useEffect)((function(){a&&h(\"\")}),[a]);var m=Object(i.useCallback)((function(){if(!p||!p.trim())return alert(\"\\uac8c\\uc2dc\\uae00\\uc744 \\uc791\\uc131\\ud558\\uc138\\uc694.\");var t=new FormData;return n.forEach((function(e){t.append(\"image\",e)})),t.append(\"content\",p),e({type:d.e,data:t})}),[p,n]),g=Object(i.useRef)(),v=Object(i.useCallback)((function(){g.current.click()}),[g.current]),w=Object(i.useCallback)((function(t){console.log(\"images\",t.target.files);var n=new FormData;[].forEach.call(t.target.files,(function(e){n.append(\"image\",e)})),e({type:d.G,data:n})}),[]),x=Object(i.useCallback)((function(t){return function(){e({type:d.v,data:t})}}),[]);return Object(c.jsxs)(s.a,{style:{margin:\"10px 0 20px\"},encType:\"multipart/form-data\",onFinish:m,children:[Object(c.jsx)(l.a.TextArea,{value:p,onChange:O,maxLength:140,placeholder:\"\\uc5b4\\ub5a4 \\uc2e0\\uae30\\ud55c \\uc77c\\uc774 \\uc788\\uc5c8\\ub098\\uc694?\"}),Object(c.jsxs)(\"div\",{children:[Object(c.jsx)(\"input\",{type:\"file\",name:\"image\",multiple:!0,hidden:!0,ref:g,onChange:w}),Object(c.jsx)(u.a,{onClick:v,children:\"\\uc774\\ubbf8\\uc9c0 \\uc5c5\\ub85c\\ub4dc\"}),Object(c.jsx)(u.a,{type:\"primary\",style:{float:\"right\"},htmlType:\"submit\",children:\"\\ub4f1\\ub85d\"})]}),Object(c.jsx)(\"div\",{children:n.map((function(e,t){return Object(c.jsxs)(\"div\",{style:{display:\"inline-block\"},children:[Object(c.jsx)(\"img\",{src:\"http://localhost:3065/\".concat(e),style:{width:\"200px\"},alt:e}),Object(c.jsx)(\"div\",{children:Object(c.jsx)(u.a,{onClick:x(t),children:\"\\uc81c\\uac70\"})})]},e)}))})]})},b=n(\"kduo\"),p=!0;t.default=function(){var e=Object(r.b)(),t=Object(r.c)((function(e){return e.user})).me,n=Object(r.c)((function(e){return e.post})),o=n.mainPosts,s=n.hasMorePosts,l=n.loadPostsLoading,u=n.retweetError;return Object(i.useEffect)((function(){u&&alert(u)}),[u]),Object(i.useEffect)((function(){function t(){if(window.pageYOffset+document.documentElement.clientHeight>document.documentElement.scrollHeight-300&&s&&!l){var t,n=null===(t=o[o.length-1])||void 0===t?void 0:t.id;e({type:d.n,lastId:n})}}return window.addEventListener(\"scroll\",t),function(){window.removeEventListener(\"scroll\",t)}}),[s,l,o]),Object(c.jsxs)(a.a,{children:[t&&Object(c.jsx)(f,{}),o.map((function(e){return Object(c.jsx)(b.a,{post:e},e.id)}))]})}},vlRD:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/\",function(){return n(\"RNiq\")}])}},[[\"vlRD\",0,1,4,7,2,3,5,6,8]]]);","map":{"version":3,"sources":["static/chunks/pages/index-3f20fcf160cb5628aa46.js"],"names":["_N_E","window","push","RNiq","module","__webpack_exports__","__webpack_require__","r","d","__N_SSP","jsx_runtime","react","es","AppLayout","slicedToArray","es_form","input","es_button","reducers_post","useInput","components_PostForm","dispatch","Object","_useSelector","state","post","imagePaths","addPostDone","_useInput","_useInput2","text","onChangeText","setText","onSubmit","trim","alert","formData","FormData","forEach","p","append","type","data","imageInput","onClickImageUpload","current","click","onChangeImages","e","console","log","target","files","imageFormData","call","f","onRemoveImage","index","style","margin","encType","onFinish","children","TextArea","value","onChange","maxLength","placeholder","name","multiple","hidden","ref","onClick","float","htmlType","map","v","i","display","src","concat","width","alt","PostCard","me","user","_useSelector2","mainPosts","hasMorePosts","loadPostsLoading","retweetError","onScroll","pageYOffset","document","documentElement","clientHeight","scrollHeight","_mainPosts","lastId","length","id","addEventListener","removeEventListener","vlRD","exports","__NEXT_P"],"mappings":"AAAAA,MACCC,OAAyB,iBAAIA,OAAyB,kBAAK,IAAIC,KAAK,CAAC,CAAC,IAAI,CAErEC,KACA,SAAUC,EAAQC,EAAqBC,GAE7C,aAEAA,EAAoBC,EAAEF,GAGtBC,EAAoBE,EAAEH,EAAqB,WAAW,WAAa,OAAqBI,KAGxF,IAAIC,EAAcJ,EAAoB,QAGlCK,EAAQL,EAAoB,QAG5BM,EAAKN,EAAoB,QAGzBO,EAAYP,EAAoB,QAGhCQ,EAAgBR,EAAoB,QAGpCS,EAAUT,EAAoB,QAG9BU,EAAQV,EAAoB,QAG5BW,EAAYX,EAAoB,QAGhCY,EAAgBZ,EAAoB,QAGpCa,EAAWb,EAAoB,QA4HFc,EAhHT,WACtB,IAAIC,EAAWC,OAAOV,EAAwB,EAA/BU,GAEXC,EAAeD,OAAOV,EAAwB,EAA/BU,EAAkC,SAAUE,GAC7D,OAAOA,EAAMC,QAEXC,EAAaH,EAAaG,WAC1BC,EAAcJ,EAAaI,YAE3BC,EAAYN,OAAOH,EAA0B,EAAjCG,CAAoC,IAChDO,EAAaP,OAAOR,EAA+B,EAAtCQ,CAAyCM,EAAW,GACjEE,EAAOD,EAAW,GAClBE,EAAeF,EAAW,GAC1BG,EAAUH,EAAW,GAEzBP,OAAOX,EAAiB,UAAxBW,EAA2B,WACrBK,GACFK,EAAQ,MAET,CAACL,IACJ,IAAIM,EAAWX,OAAOX,EAAmB,YAA1BW,EAA6B,WAC1C,IAAKQ,IAASA,EAAKI,OACjB,OAAOC,MAAM,4DAGf,IAAIC,EAAW,IAAIC,SAKnB,OAJAX,EAAWY,SAAQ,SAAUC,GAC3BH,EAASI,OAAO,QAASD,MAE3BH,EAASI,OAAO,UAAWV,GACpBT,EAAS,CACdoB,KAAMvB,EAAwC,EAC9CwB,KAAMN,MAEP,CAACN,EAAMJ,IACNiB,EAAarB,OAAOX,EAAc,OAArBW,GACbsB,EAAqBtB,OAAOX,EAAmB,YAA1BW,EAA6B,WACpDqB,EAAWE,QAAQC,UAClB,CAACH,EAAWE,UACXE,EAAiBzB,OAAOX,EAAmB,YAA1BW,EAA6B,SAAU0B,GAC1DC,QAAQC,IAAI,SAAUF,EAAEG,OAAOC,OAC/B,IAAIC,EAAgB,IAAIhB,SACxB,GAAGC,QAAQgB,KAAKN,EAAEG,OAAOC,OAAO,SAAUG,GACxCF,EAAcb,OAAO,QAASe,MAEhClC,EAAS,CACPoB,KAAMvB,EAA6C,EACnDwB,KAAMW,MAEP,IACCG,EAAgBlC,OAAOX,EAAmB,YAA1BW,EAA6B,SAAUmC,GACzD,OAAO,WACLpC,EAAS,CACPoB,KAAMvB,EAAoC,EAC1CwB,KAAMe,OAGT,IACH,OAAoBnC,OAAOZ,EAAkB,KAAzBY,CAA4BP,EAAyB,EAAG,CAC1E2C,MAAO,CACLC,OAAQ,eAEVC,QAAS,sBACTC,SAAU5B,EACV6B,SAAU,CAAcxC,OAAOZ,EAAiB,IAAxBY,CAA2BN,EAAuB,EAAE+C,SAAU,CACpFC,MAAOlC,EACPmC,SAAUlC,EACVmC,UAAW,IACXC,YAAa,2EACE7C,OAAOZ,EAAkB,KAAzBY,CAA4B,MAAO,CAClDwC,SAAU,CAAcxC,OAAOZ,EAAiB,IAAxBY,CAA2B,QAAS,CAC1DmB,KAAM,OACN2B,KAAM,QACNC,UAAU,EACVC,QAAQ,EACRC,IAAK5B,EACLsB,SAAUlB,IACKzB,OAAOZ,EAAiB,IAAxBY,CAA2BL,EAA2B,EAAG,CACxEuD,QAAS5B,EACTkB,SAAU,0CACKxC,OAAOZ,EAAiB,IAAxBY,CAA2BL,EAA2B,EAAG,CACxEwB,KAAM,UACNiB,MAAO,CACLe,MAAS,SAEXC,SAAU,SACVZ,SAAU,oBAEGxC,OAAOZ,EAAiB,IAAxBY,CAA2B,MAAO,CACjDwC,SAAUpC,EAAWiD,KAAI,SAAUC,EAAGC,GACpC,OAAoBvD,OAAOZ,EAAkB,KAAzBY,CAA4B,MAAO,CACrDoC,MAAO,CACLoB,QAAS,gBAEXhB,SAAU,CAAcxC,OAAOZ,EAAiB,IAAxBY,CAA2B,MAAO,CACxDyD,IAAK,yBAAyBC,OAAOJ,GACrClB,MAAO,CACLuB,MAAO,SAETC,IAAKN,IACUtD,OAAOZ,EAAiB,IAAxBY,CAA2B,MAAO,CACjDwC,SAAuBxC,OAAOZ,EAAiB,IAAxBY,CAA2BL,EAA2B,EAAG,CAC9EuD,QAAShB,EAAcqB,GACvBf,SAAU,qBAGbc,YAQPO,EAAW7E,EAAoB,QAmE/BG,GAAU,EAC2BJ,EAA6B,QAtDrD,WACf,IAAIgB,EAAWC,OAAOV,EAAwB,EAA/BU,GAKX8D,EAHe9D,OAAOV,EAAwB,EAA/BU,EAAkC,SAAUE,GAC7D,OAAOA,EAAM6D,QAEOD,GAElBE,EAAgBhE,OAAOV,EAAwB,EAA/BU,EAAkC,SAAUE,GAC9D,OAAOA,EAAMC,QAEX8D,EAAYD,EAAcC,UAC1BC,EAAeF,EAAcE,aAC7BC,EAAmBH,EAAcG,iBACjCC,EAAeJ,EAAcI,aA4BjC,OA1BApE,OAAOX,EAAiB,UAAxBW,EAA2B,WACrBoE,GACFvD,MAAMuD,KAEP,CAACA,IACJpE,OAAOX,EAAiB,UAAxBW,EAA2B,WACzB,SAASqE,IACP,GAAI1F,OAAO2F,YAAcC,SAASC,gBAAgBC,aAAeF,SAASC,gBAAgBE,aAAe,KACnGR,IAAiBC,EAAkB,CACrC,IAAIQ,EAEAC,EAA4D,QAAlDD,EAAaV,EAAUA,EAAUY,OAAS,UAA+B,IAAfF,OAAwB,EAASA,EAAWG,GACpH/E,EAAS,CACPoB,KAAMvB,EAA0C,EAChDgF,OAAQA,KAOhB,OADAjG,OAAOoG,iBAAiB,SAAUV,GAC3B,WACL1F,OAAOqG,oBAAoB,SAAUX,MAEtC,CAACH,EAAcC,EAAkBF,IAEhBjE,OAAOZ,EAAkB,KAAzBY,CAA4BT,EAA2B,EAAG,CAC5EiD,SAAU,CAACsB,GAAmB9D,OAAOZ,EAAiB,IAAxBY,CAA2BF,EAAqB,IAAKmE,EAAUZ,KAAI,SAAUlD,GACzG,OAAoBH,OAAOZ,EAAiB,IAAxBY,CAA2B6D,EAA0B,EAAG,CAC1E1D,KAAMA,GACLA,EAAK2E,YAiBRG,KACA,SAAUnG,EAAQoG,EAASlG,IAG1BL,OAAOwG,SAAWxG,OAAOwG,UAAY,IAAIvG,KAAK,CAC7C,IACA,WACE,OAAOI,EAAoB,aAOnC,CAAC,CAAC,OAAO,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE"},"name":"static/chunks/pages/index-3f20fcf160cb5628aa46.js","input":"_N_E =\n(window[\"webpackJsonp_N_E\"] = window[\"webpackJsonp_N_E\"] || []).push([[17],{\n\n/***/ \"RNiq\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"__N_SSP\", function() { return /* binding */ __N_SSP; });\n\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(\"nKUr\");\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(\"q1tI\");\n\n// EXTERNAL MODULE: ./node_modules/react-redux/es/index.js + 22 modules\nvar es = __webpack_require__(\"/MKj\");\n\n// EXTERNAL MODULE: ./components/AppLayout.js + 10 modules\nvar AppLayout = __webpack_require__(\"1zst\");\n\n// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 1 modules\nvar slicedToArray = __webpack_require__(\"ODXe\");\n\n// EXTERNAL MODULE: ./node_modules/antd/es/form/index.js + 25 modules\nvar es_form = __webpack_require__(\"Vl3Y\");\n\n// EXTERNAL MODULE: ./node_modules/antd/es/input/index.js + 8 modules\nvar input = __webpack_require__(\"5rEg\");\n\n// EXTERNAL MODULE: ./node_modules/antd/es/button/index.js + 5 modules\nvar es_button = __webpack_require__(\"2/Rp\");\n\n// EXTERNAL MODULE: ./reducers/post.js\nvar reducers_post = __webpack_require__(\"p+NB\");\n\n// EXTERNAL MODULE: ./hooks/useInput.js\nvar useInput = __webpack_require__(\"3zrx\");\n\n// CONCATENATED MODULE: ./components/PostForm.js\n\n\n\n\n\n\n\n\n\nvar PostForm_PostForm = function PostForm() {\n  var dispatch = Object(es[\"b\" /* useDispatch */])();\n\n  var _useSelector = Object(es[\"c\" /* useSelector */])(function (state) {\n    return state.post;\n  }),\n      imagePaths = _useSelector.imagePaths,\n      addPostDone = _useSelector.addPostDone;\n\n  var _useInput = Object(useInput[\"a\" /* default */])(''),\n      _useInput2 = Object(slicedToArray[\"a\" /* default */])(_useInput, 3),\n      text = _useInput2[0],\n      onChangeText = _useInput2[1],\n      setText = _useInput2[2];\n\n  Object(react[\"useEffect\"])(function () {\n    if (addPostDone) {\n      setText('');\n    }\n  }, [addPostDone]);\n  var onSubmit = Object(react[\"useCallback\"])(function () {\n    if (!text || !text.trim()) {\n      return alert('게시글을 작성하세요.');\n    }\n\n    var formData = new FormData();\n    imagePaths.forEach(function (p) {\n      formData.append('image', p);\n    });\n    formData.append('content', text);\n    return dispatch({\n      type: reducers_post[\"e\" /* ADD_POST_REQUEST */],\n      data: formData\n    });\n  }, [text, imagePaths]);\n  var imageInput = Object(react[\"useRef\"])();\n  var onClickImageUpload = Object(react[\"useCallback\"])(function () {\n    imageInput.current.click();\n  }, [imageInput.current]);\n  var onChangeImages = Object(react[\"useCallback\"])(function (e) {\n    console.log('images', e.target.files);\n    var imageFormData = new FormData();\n    [].forEach.call(e.target.files, function (f) {\n      imageFormData.append('image', f);\n    });\n    dispatch({\n      type: reducers_post[\"G\" /* UPLOAD_IMAGES_REQUEST */],\n      data: imageFormData\n    });\n  }, []);\n  var onRemoveImage = Object(react[\"useCallback\"])(function (index) {\n    return function () {\n      dispatch({\n        type: reducers_post[\"v\" /* REMOVE_IMAGE */],\n        data: index\n      });\n    };\n  }, []);\n  return /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(es_form[\"a\" /* default */], {\n    style: {\n      margin: '10px 0 20px'\n    },\n    encType: \"multipart/form-data\",\n    onFinish: onSubmit,\n    children: [/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(input[\"a\" /* default */].TextArea, {\n      value: text,\n      onChange: onChangeText,\n      maxLength: 140,\n      placeholder: \"\\uC5B4\\uB5A4 \\uC2E0\\uAE30\\uD55C \\uC77C\\uC774 \\uC788\\uC5C8\\uB098\\uC694?\"\n    }), /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\", {\n      children: [/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"input\", {\n        type: \"file\",\n        name: \"image\",\n        multiple: true,\n        hidden: true,\n        ref: imageInput,\n        onChange: onChangeImages\n      }), /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(es_button[\"a\" /* default */], {\n        onClick: onClickImageUpload,\n        children: \"\\uC774\\uBBF8\\uC9C0 \\uC5C5\\uB85C\\uB4DC\"\n      }), /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(es_button[\"a\" /* default */], {\n        type: \"primary\",\n        style: {\n          \"float\": 'right'\n        },\n        htmlType: \"submit\",\n        children: \"\\uB4F1\\uB85D\"\n      })]\n    }), /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\", {\n      children: imagePaths.map(function (v, i) {\n        return /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\", {\n          style: {\n            display: 'inline-block'\n          },\n          children: [/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"img\", {\n            src: \"http://localhost:3065/\".concat(v),\n            style: {\n              width: '200px'\n            },\n            alt: v\n          }), /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\", {\n            children: /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(es_button[\"a\" /* default */], {\n              onClick: onRemoveImage(i),\n              children: \"\\uC81C\\uAC70\"\n            })\n          })]\n        }, v);\n      })\n    })]\n  });\n};\n\n/* harmony default export */ var components_PostForm = (PostForm_PostForm);\n// EXTERNAL MODULE: ./components/PostCard.js + 23 modules\nvar PostCard = __webpack_require__(\"kduo\");\n\n// CONCATENATED MODULE: ./pages/index.js\n\n\n\n\n //next에선 import React를 반드시 할 필요가 없다.\n//next는 pages 폴더를 인식해서 개별적으로 페이지로 만든다.\n\n\n\n\n\nvar pages_Home = function Home() {\n  var dispatch = Object(es[\"b\" /* useDispatch */])();\n\n  var _useSelector = Object(es[\"c\" /* useSelector */])(function (state) {\n    return state.user;\n  }),\n      me = _useSelector.me;\n\n  var _useSelector2 = Object(es[\"c\" /* useSelector */])(function (state) {\n    return state.post;\n  }),\n      mainPosts = _useSelector2.mainPosts,\n      hasMorePosts = _useSelector2.hasMorePosts,\n      loadPostsLoading = _useSelector2.loadPostsLoading,\n      retweetError = _useSelector2.retweetError;\n\n  Object(react[\"useEffect\"])(function () {\n    if (retweetError) {\n      alert(retweetError);\n    }\n  }, [retweetError]);\n  Object(react[\"useEffect\"])(function () {\n    function onScroll() {\n      if (window.pageYOffset + document.documentElement.clientHeight > document.documentElement.scrollHeight - 300) {\n        if (hasMorePosts && !loadPostsLoading) {\n          var _mainPosts;\n\n          var lastId = (_mainPosts = mainPosts[mainPosts.length - 1]) === null || _mainPosts === void 0 ? void 0 : _mainPosts.id;\n          dispatch({\n            type: reducers_post[\"n\" /* LOAD_POSTS_REQUEST */],\n            lastId: lastId\n          });\n        }\n      }\n    }\n\n    window.addEventListener('scroll', onScroll);\n    return function () {\n      window.removeEventListener('scroll', onScroll); //종료하지 않으면 큰일남.\n    };\n  }, [hasMorePosts, loadPostsLoading, mainPosts]); // 스크롤 끝까지 내릴시 로딩 후 이미지 가져오기\n\n  return /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(AppLayout[\"a\" /* default */], {\n    children: [me && /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(components_PostForm, {}), mainPosts.map(function (post) {\n      return /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(PostCard[\"a\" /* default */], {\n        post: post\n      }, post.id);\n    })]\n  }) // AppLayout은 components 폴더에 있다.\n  // AppLayout 안에 있는 div는 {children}이 된다. \n  ;\n};\n\nvar __N_SSP = true;\n/* harmony default export */ var pages = __webpack_exports__[\"default\"] = (pages_Home); // npm run dev 라고 입력하면 package.json 에 scripts에 정의해둔\n// 스크립트가 실행된다. dev 말고 정의해둔 값을 입력하면 스크립트 실행된다.\n// antd, antd icon 따로 설치 \n// antd는 ant design으로 중국 디자인 사이트\n// antd 안먹히면 @ctrl/tinycolor 3.3.1 추가해라\n// next를 사용하는 이유는 서버사이드 렌더링 때문\n\n/***/ }),\n\n/***/ \"vlRD\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\n      (window.__NEXT_P = window.__NEXT_P || []).push([\n        \"/\",\n        function () {\n          return __webpack_require__(\"RNiq\");\n        }\n      ]);\n    \n\n/***/ })\n\n},[[\"vlRD\",0,1,4,7,2,3,5,6,8]]]);","inputSourceMap":{"version":3,"sources":["C:\\job\\react-nodebird\\prepare\\front\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!C:\\job\\react-nodebird\\prepare\\front\\components\\PostForm.js","C:\\job\\react-nodebird\\prepare\\front\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!C:\\job\\react-nodebird\\prepare\\front\\pages\\index.js","C:\\job\\react-nodebird\\prepare\\front\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-client-pages-loader.js?page=%2F&absolutePagePath=private-next-pages%2Findex.js!"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAkD;AACF;AACuE;AACzD;AACnB;AACY;AAC2C;AACzD;;AAEzC,IAAI,iBAAQ;AACZ,iBAAiB,iCAAW;;AAE5B,qBAAqB,iCAAW;AAChC;AACA,GAAG;AACH;AACA;;AAEA,kBAAkB,mCAAQ;AAC1B,mBAAmB,wCAAc;AACjC;AACA;AACA;;AAEA,EAAE,0BAAS;AACX;AACA;AACA;AACA,GAAG;AACH,iBAAiB,4BAAW;AAC5B;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,YAAY,yCAAgB;AAC5B;AACA,KAAK;AACL,GAAG;AACH,mBAAmB,uBAAM;AACzB,2BAA2B,4BAAW;AACtC;AACA,GAAG;AACH,uBAAuB,4BAAW;AAClC;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,YAAY,8CAAqB;AACjC;AACA,KAAK;AACL,GAAG;AACH,sBAAsB,4BAAW;AACjC;AACA;AACA,cAAc,qCAAY;AAC1B;AACA,OAAO;AACP;AACA,GAAG;AACH,sBAAsB,2BAAK,CAAC,0BAAI;AAChC;AACA;AACA,KAAK;AACL;AACA;AACA,4BAA4B,0BAAI,CAAC,wBAAK;AACtC;AACA;AACA;AACA;AACA,KAAK,gBAAgB,2BAAK;AAC1B,8BAA8B,0BAAI;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,gBAAgB,0BAAI,CAAC,4BAAM;AAClC;AACA;AACA,OAAO,gBAAgB,0BAAI,CAAC,4BAAM;AAClC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP,KAAK,gBAAgB,0BAAI;AACzB;AACA,4BAA4B,2BAAK;AACjC;AACA;AACA,WAAW;AACX,kCAAkC,0BAAI;AACtC;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,gBAAgB,0BAAI;AAC/B,mCAAmC,0BAAI,CAAC,4BAAM;AAC9C;AACA;AACA,aAAa;AACb,WAAW;AACX,SAAS;AACT,OAAO;AACP,KAAK;AACL,GAAG;AACH;;AAEe,yEAAQ,E;;;;;ACzH2B;AACF;AACP;AACc;AACP;AAChD;;AAE8C;AACA;AACQ;;AAEtD,IAAI,UAAI;AACR,iBAAiB,iCAAW;;AAE5B,qBAAqB,iCAAW;AAChC;AACA,GAAG;AACH;;AAEA,sBAAsB,iCAAW;AACjC;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA,EAAE,0BAAS;AACX;AACA;AACA;AACA,GAAG;AACH,EAAE,0BAAS;AACX;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,2CAAkB;AACpC;AACA,WAAW;AACX;AACA;AACA;;AAEA;AACA;AACA,qDAAqD;AACrD;AACA,GAAG,+CAA+C;;AAElD,sBAAsB,2BAAK,CAAC,4BAAS;AACrC,kCAAkC,0BAAI,CAAC,mBAAQ,IAAI;AACnD,0BAA0B,0BAAI,CAAC,2BAAQ;AACvC;AACA,OAAO;AACP,KAAK;AACL,GAAG;AACH,2BAA2B,SAAS;AACpC;AACA;;AAEO;AACQ,qFAAI,EAAC;AACpB;AACA;AACA;AACA;AACA,8B;;;;;;;;ACrEA;AACA;AACA;AACA,iBAAiB,mBAAO,CAAC,MAA6B;AACtD;AACA","file":"x","sourcesContent":["import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _slicedToArray from \"C:/job/react-nodebird/prepare/front/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport React, { useCallback, useRef, useEffect } from 'react';\nimport { Form, Input, Button } from 'antd';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { addPost, UPLOAD_IMAGES_REQUEST, REMOVE_IMAGE, ADD_POST_REQUEST } from '../reducers/post';\nimport useInput from '../hooks/useInput';\n\nvar PostForm = function PostForm() {\n  var dispatch = useDispatch();\n\n  var _useSelector = useSelector(function (state) {\n    return state.post;\n  }),\n      imagePaths = _useSelector.imagePaths,\n      addPostDone = _useSelector.addPostDone;\n\n  var _useInput = useInput(''),\n      _useInput2 = _slicedToArray(_useInput, 3),\n      text = _useInput2[0],\n      onChangeText = _useInput2[1],\n      setText = _useInput2[2];\n\n  useEffect(function () {\n    if (addPostDone) {\n      setText('');\n    }\n  }, [addPostDone]);\n  var onSubmit = useCallback(function () {\n    if (!text || !text.trim()) {\n      return alert('게시글을 작성하세요.');\n    }\n\n    var formData = new FormData();\n    imagePaths.forEach(function (p) {\n      formData.append('image', p);\n    });\n    formData.append('content', text);\n    return dispatch({\n      type: ADD_POST_REQUEST,\n      data: formData\n    });\n  }, [text, imagePaths]);\n  var imageInput = useRef();\n  var onClickImageUpload = useCallback(function () {\n    imageInput.current.click();\n  }, [imageInput.current]);\n  var onChangeImages = useCallback(function (e) {\n    console.log('images', e.target.files);\n    var imageFormData = new FormData();\n    [].forEach.call(e.target.files, function (f) {\n      imageFormData.append('image', f);\n    });\n    dispatch({\n      type: UPLOAD_IMAGES_REQUEST,\n      data: imageFormData\n    });\n  }, []);\n  var onRemoveImage = useCallback(function (index) {\n    return function () {\n      dispatch({\n        type: REMOVE_IMAGE,\n        data: index\n      });\n    };\n  }, []);\n  return /*#__PURE__*/_jsxs(Form, {\n    style: {\n      margin: '10px 0 20px'\n    },\n    encType: \"multipart/form-data\",\n    onFinish: onSubmit,\n    children: [/*#__PURE__*/_jsx(Input.TextArea, {\n      value: text,\n      onChange: onChangeText,\n      maxLength: 140,\n      placeholder: \"\\uC5B4\\uB5A4 \\uC2E0\\uAE30\\uD55C \\uC77C\\uC774 \\uC788\\uC5C8\\uB098\\uC694?\"\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      children: [/*#__PURE__*/_jsx(\"input\", {\n        type: \"file\",\n        name: \"image\",\n        multiple: true,\n        hidden: true,\n        ref: imageInput,\n        onChange: onChangeImages\n      }), /*#__PURE__*/_jsx(Button, {\n        onClick: onClickImageUpload,\n        children: \"\\uC774\\uBBF8\\uC9C0 \\uC5C5\\uB85C\\uB4DC\"\n      }), /*#__PURE__*/_jsx(Button, {\n        type: \"primary\",\n        style: {\n          \"float\": 'right'\n        },\n        htmlType: \"submit\",\n        children: \"\\uB4F1\\uB85D\"\n      })]\n    }), /*#__PURE__*/_jsx(\"div\", {\n      children: imagePaths.map(function (v, i) {\n        return /*#__PURE__*/_jsxs(\"div\", {\n          style: {\n            display: 'inline-block'\n          },\n          children: [/*#__PURE__*/_jsx(\"img\", {\n            src: \"http://localhost:3065/\".concat(v),\n            style: {\n              width: '200px'\n            },\n            alt: v\n          }), /*#__PURE__*/_jsx(\"div\", {\n            children: /*#__PURE__*/_jsx(Button, {\n              onClick: onRemoveImage(i),\n              children: \"\\uC81C\\uAC70\"\n            })\n          })]\n        }, v);\n      })\n    })]\n  });\n};\n\nexport default PostForm;","import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport AppLayout from '../components/AppLayout'; //next에선 import React를 반드시 할 필요가 없다.\n//next는 pages 폴더를 인식해서 개별적으로 페이지로 만든다.\n\nimport PostForm from '../components/PostForm';\nimport PostCard from '../components/PostCard';\nimport { LOAD_POSTS_REQUEST } from '../reducers/post';\n\nvar Home = function Home() {\n  var dispatch = useDispatch();\n\n  var _useSelector = useSelector(function (state) {\n    return state.user;\n  }),\n      me = _useSelector.me;\n\n  var _useSelector2 = useSelector(function (state) {\n    return state.post;\n  }),\n      mainPosts = _useSelector2.mainPosts,\n      hasMorePosts = _useSelector2.hasMorePosts,\n      loadPostsLoading = _useSelector2.loadPostsLoading,\n      retweetError = _useSelector2.retweetError;\n\n  useEffect(function () {\n    if (retweetError) {\n      alert(retweetError);\n    }\n  }, [retweetError]);\n  useEffect(function () {\n    function onScroll() {\n      if (window.pageYOffset + document.documentElement.clientHeight > document.documentElement.scrollHeight - 300) {\n        if (hasMorePosts && !loadPostsLoading) {\n          var _mainPosts;\n\n          var lastId = (_mainPosts = mainPosts[mainPosts.length - 1]) === null || _mainPosts === void 0 ? void 0 : _mainPosts.id;\n          dispatch({\n            type: LOAD_POSTS_REQUEST,\n            lastId: lastId\n          });\n        }\n      }\n    }\n\n    window.addEventListener('scroll', onScroll);\n    return function () {\n      window.removeEventListener('scroll', onScroll); //종료하지 않으면 큰일남.\n    };\n  }, [hasMorePosts, loadPostsLoading, mainPosts]); // 스크롤 끝까지 내릴시 로딩 후 이미지 가져오기\n\n  return /*#__PURE__*/_jsxs(AppLayout, {\n    children: [me && /*#__PURE__*/_jsx(PostForm, {}), mainPosts.map(function (post) {\n      return /*#__PURE__*/_jsx(PostCard, {\n        post: post\n      }, post.id);\n    })]\n  }) // AppLayout은 components 폴더에 있다.\n  // AppLayout 안에 있는 div는 {children}이 된다. \n  ;\n};\n\nexport var __N_SSP = true;\nexport default Home; // npm run dev 라고 입력하면 package.json 에 scripts에 정의해둔\n// 스크립트가 실행된다. dev 말고 정의해둔 값을 입력하면 스크립트 실행된다.\n// antd, antd icon 따로 설치 \n// antd는 ant design으로 중국 디자인 사이트\n// antd 안먹히면 @ctrl/tinycolor 3.3.1 추가해라\n// next를 사용하는 이유는 서버사이드 렌더링 때문","\n      (window.__NEXT_P = window.__NEXT_P || []).push([\n        \"/\",\n        function () {\n          return require(\"private-next-pages/index.js\");\n        }\n      ]);\n    "]}}